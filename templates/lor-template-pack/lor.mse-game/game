mse version: 2.0.0
short name: LoR
full name: Legends of Runeterra
installer group: Legends of Runeterra/game files
icon: card-sample.png
position hint: 03

version: 2019-10-30

# Author : kino
# Most stuff is copy/pasted from magic.mse-game (and vanguard.mse-game! thanks Wolfwood)
############################################################## Functions & filters
# General functions
init script:
	
	############################################################## The text box
	
	potential_space := { if set.add_space_after_color_code then " " else "" }
	
	text_filter := 
		replace@(
			match: "(\\[.+?\\])",
		 	replace: { "<color:rgb(250, 214, 90)>" + substring(input, begin:1, end:length(input) - 1) + "</color>" + potential_space() }) +
		replace@(
		 	match: "(\\\{.+?\\\})",
		 	replace: { "<color:rgb(73, 160, 248)>" + substring(input, begin:1, end:length(input) - 1) + "</color>" + potential_space() }) +
		replace@(
			match: "(\\(.\\))",
		 	replace: { "<sym>" + substring(input, begin:1, end:length(input) - 1) + "</sym>" }) +
		replace@(
		 	match: "(\\*.+?\\*)",
		 	replace: { remove_tag(tag: "<color:rgb(250, 214, 90)>", remove_tag(tag: "<color:rgb(73, 160, 248)>", remove_tag(tag: "</color>", substring(input, begin:1, end:length(input) - 1)))) })

	template_type := {
		if substring(stylesheet.short_name, end:8) == "Champion" then "Champion"
		else if substring(stylesheet.short_name, end:8) == "Follower" then "Follower"
		else if substring(stylesheet.short_name, end:5) == "Spell" then "Spell"
		else stylesheet.short_name }
	type_line := {
		if template_type() == "Champion" then (
			if styling.set_level == "Level 2" then
				"Unit — Champion (Lvl.2)"
			else "Unit — Champion (Lvl.1)" )
		else if template_type() == "Follower" then (
			if styling.number_of_keywords == 1 and card.keywordtext == "TRAP" then
				"Trap"
			else "Unit — Follower" )
		else if template_type() == "Spell" then (
			if card.keywordtext == "SKILL" then
				"Skill"
			else if card.keywordtext != "" then
				"Spell — " + to_title(card.keywordtext)
			else if set.automatic_keyword_text and substring(card.keysymbolreal, end:5) == "Spell" then
				"Spell — " + substring(card.keysymbolreal, begin:6)
			else if set.automatic_keyword_text and substring(card.keysymbolreal, end:8) == "Standard" then
				"Spell — " + substring(card.keysymbolreal, begin:9)
			else "Spell" )
		else "???" }

	keyword_filter := {
		if substring(card.keysymbolreal, end:5) == "Spell" and set.automatic_keyword_text then
			to_upper(substring(card.keysymbolreal, begin:6))
		else if substring(card.keysymbolreal, end:8) == "Standard" and set.automatic_keyword_text then
			to_upper(substring(card.keysymbolreal, begin:9))
		else value }

	############################################################## Other boxes
	
	# Process the name for sorting rules
	sort_name :=
		# Remove "The", "A", and "And" at the beginning
		replace@(match: "^(The|An?) ", replace: "") +
		# Remove commas and apostrophes
		replace@(match: "(,|'|’)", replace: "") +
		# Remove bold and italic tags
		replace@(match: "(<b>|<i>|</b>|</i>)", replace: "") +
		# Make lowercase
		to_lower
	
	word_count := break_text@(match:"[^[:space:]]+") + length
	line_count := split_text@(match:"\n+",include_empty:false) + length
	
############################################################## Set fields
set field:
	type: info
	name: Set Information
set field:
	type: text
	name: title
	description: The name of the set.
set field:
	type: text
	name: description
	multi line: true
	description: The summary of the set.
set field:
	type: text
	name: artist
	description: Enter an artist's name to have it appear in the bottom left of all cards by default.
set field:
	type: text
	name: copyright
	description: Enter a designer's name to have it appear in the bottom right of all cards.
set field:
	type: info
	name: Defaults and Automation
set field:
	type: boolean
	name: add space after color code
	initial: no
	description: Adds a space after adding a color code to ability text.
set field:
	type: boolean
	name: automatic keyword text
	initial: yes
	description: Automatically fills the keyword text box according to the keyword symbol used.
set field:
	type: boolean
	name: automatic card numbers
	initial: no
	description: This is actually useless but the code breaks if I remove it so yeah
set field:
	type: info
	name: Custom Links
set field:
	type: text
	name: Custom Region 1
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom region menu.
set field:
	type: text
	name: Custom Region 2
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom region menu.
set field:
	type: text
	name: Custom Region 3
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom region menu.
set field:
	type: text
	name: Custom Region 4
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom region menu.
set field:
	type: text
	name: Custom Region 5
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom region menu.
set field:
	type: text
	name: Custom Symbol 1
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom symbol menu. Does not work for in-line keywords.
set field:
	type: text
	name: Custom Symbol 2
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom symbol menu. Does not work for in-line keywords.
set field:
	type: text
	name: Custom Symbol 3
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom symbol menu. Does not work for in-line keywords.
set field:
	type: text
	name: Custom Symbol 4
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom symbol menu. Does not work for in-line keywords.
set field:
	type: text
	name: Custom Symbol 5
	description: Place an image file in the custom folder in LoR.mse-game and enter its filename here to have it appear on the custom symbol menu. Does not work for in-line keywords.
############################# Default style
default set style:
	title:
		padding left: 2
		font:
			size: 16
############################################################## Card fields
############################# Background stuff
card field:
	type: choice
	name: background
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: typebox
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: backdrop
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: darkness
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: artist arrow
	choice: normal
	show statistics: false
	editable: false
############################# Name line
card field:
	type: text
	name: name
	identifying: true
	show statistics: false
	card list visible: true
	card list column: 1
	card list width: 150
	multi line: true
	description: The name of the card
############################# Image
card field:
	type: image
	name: image
	show statistics: false
	description: The image of the card
card field:
	type: image
	name: image2
	show statistics: false
	description: The secondary image of the card
############################# Card type
card field:
	type: choice
	name: region
	card list visible: true
	card list column: 3
	card list width: 100
	description: The region of the card
	icon: stats/card_type.png
	choice: 
		name: None
		line below: true
	choice: Demacia
	choice: Shadow Isles
	choice: Noxus
	choice: Ionia
	choice: Freljord
	choice: 
		name: Piltover & Zaun
		line below: true
	choice: Bilgewater
	choice: Targon
	choice: Bandle City
	choice: Ixtal
	choice: Shurima
	choice: The Void
	choice: 
		name: Runeterra
		line below: true
	choice: 
		name: Custom
		choice: Region 1
		choice: Region 2
		choice: Region 3
		choice: Region 4
		choice: Region 5
	initial: Runeterra
card field:
	type: choice
	name: rarity
	card list visible: true
	card list column: 7
	card list width: 100
	description: The rarity of the card
	default: if template_type() == "Champion" then (if styling.set_level == "Level 2" then "None" else "Champion") else "Common"
	script: 
		if template_type() != "Champion" and value == "Champion" then "Common"
		else if template_type() == "Champion" and (value != "Champion" and value != "None") then (if styling.set_level == "Level 2" then "None" else "Champion")
		else value
	choice: 
		name: Champion
		enabled: { template_type() == "Champion" }
	choice: 
		name: Epic
		enabled: { template_type() != "Champion" }
	choice: 
		name: Rare
		enabled: { template_type() != "Champion" }
	choice: 
		name: Common
		enabled: { template_type() != "Champion" }
		line below: true
	choice: None
card field:
	type: text
	name: category
	card list visible: true
	card list column: 2
	card list width: 200
	card list name: type
	description: The type of card
	script: type_line()
############################# Text box
card field:
	type: text
	name: ability
	script: text_filter(value)
	show statistics: false
	multi line: true
	description: The ability text of the card
card field:
	type: text
	name: level ability
	script: text_filter(value)
	show statistics: false
	multi line: true
	description: The level ability text of the card
card field:
	type: text
	name: typetype
	show statistics: false
	description: The identifying type of the card
############################# PT
card field:
	type: text
	name: cost
	card list visible: true
	card list column: 4
	card list width: 50
	card list name: cost
	show statistics: false
	description: The cost of the card
card field:
	type: text
	name: power
	card list visible: true
	card list column: 5
	card list width: 50
	card list name: power
	show statistics: false
	description: The power of the card
card field:
	type: text
	name: health
	card list visible: true
	card list column: 6
	card list width: 50
	card list name: health
	show statistics: false
	description: The health of the card
############################# Keyword
card field:
	type: choice
	name: keywordleft
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordright
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordmiddle
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordbox1
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordbox2
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordbox3
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keywordbox4
	choice: normal
	show statistics: false
	editable: false
card field:
	type: choice
	name: keysymbolreal
	show statistics: false
	choice:
		name: None
		line below: true
	choice:
		name: Standard
		choice: Barrier
		choice: Can't Block
		choice: Challenger
		choice: Double Attack
		choice: Ephemeral
		choice: Elusive
		choice: Fearsome
		choice: Fleeting
		choice: Lifesteal
		choice: Overwhelm
		choice: Quick Attack
		choice: Regeneration
		choice: 
			name: Tough
	choice:
		name: Spell
		line below: true
		choice: Burst
		choice: Fast
		choice: Slow
	choice: 
		name: Custom
		line below: true
		choice: Symbol 1
		choice: Symbol 2
		choice: Symbol 3
		choice: Symbol 4
		choice: Symbol 5
	choice: Blank
card field:
	type: text
	name: keywordtext
	show statistics: false
	description: The keyword text
	script: keyword_filter(value)
card field:
	type: choice
	name: keysymbol1
	show statistics: false
	choice:
		name: None
		line below: true
	choice:
		name: Standard
		choice: Barrier
		choice: Can't Block
		choice: Challenger
		choice: Double Attack
		choice: Ephemeral
		choice: Elusive
		choice: Fearsome
		choice: Fleeting
		choice: Lifesteal
		choice: Overwhelm
		choice: Quick Attack
		choice: Regeneration
		choice: 
			name: Tough
	choice:
		name: Spell
		line below: true
		choice: Burst
		choice: Fast
		choice: Slow
	choice: 
		name: Custom
		line below: true
		choice: Symbol 1
		choice: Symbol 2
		choice: Symbol 3
		choice: Symbol 4
		choice: Symbol 5
card field:
	type: choice
	name: keysymbol2
	show statistics: false
	choice:
		name: None
		line below: true
	choice:
		name: Standard
		choice: Barrier
		choice: Can't Block
		choice: Challenger
		choice: Double Attack
		choice: Ephemeral
		choice: Elusive
		choice: Fearsome
		choice: Fleeting
		choice: Lifesteal
		choice: Overwhelm
		choice: Quick Attack
		choice: Regeneration
		choice: 
			name: Tough
	choice:
		name: Spell
		line below: true
		choice: Burst
		choice: Fast
		choice: Slow
	choice: 
		name: Custom
		line below: true
		choice: Symbol 1
		choice: Symbol 2
		choice: Symbol 3
		choice: Symbol 4
		choice: Symbol 5
card field:
	type: choice
	name: keysymbol3
	show statistics: false
	choice:
		name: None
		line below: true
	choice:
		name: Standard
		choice: Barrier
		choice: Can't Block
		choice: Challenger
		choice: Double Attack
		choice: Ephemeral
		choice: Elusive
		choice: Fearsome
		choice: Fleeting
		choice: Lifesteal
		choice: Overwhelm
		choice: Quick Attack
		choice: Regeneration
		choice: 
			name: Tough
	choice:
		name: Spell
		line below: true
		choice: Burst
		choice: Fast
		choice: Slow
	choice: 
		name: Custom
		line below: true
		choice: Symbol 1
		choice: Symbol 2
		choice: Symbol 3
		choice: Symbol 4
		choice: Symbol 5
card field:
	type: choice
	name: keysymbol4
	show statistics: false
	choice:
		name: None
		line below: true
	choice:
		name: Standard
		choice: Barrier
		choice: Can't Block
		choice: Challenger
		choice: Double Attack
		choice: Ephemeral
		choice: Elusive
		choice: Fearsome
		choice: Fleeting
		choice: Lifesteal
		choice: Overwhelm
		choice: Quick Attack
		choice: Regeneration
		choice: 
			name: Tough
	choice:
		name: Spell
		line below: true
		choice: Burst
		choice: Fast
		choice: Slow
	choice: 
		name: Custom
		line below: true
		choice: Symbol 1
		choice: Symbol 2
		choice: Symbol 3
		choice: Symbol 4
		choice: Symbol 5
card field:
	type: choice
	name: levelbar
	choice: normal
	show statistics: false
	editable: false
############################# Card sorting / numbering
card field:
	type: text
	name: card number
	save value: false
	script:
		position(
			of: card
			in: set
			order_by: { sort_name(card.name) }
		) + 1
		+ "/" +
		number_of_items(in: set)
	card list visible: true
	card list column: 10
	card list width: 50
	card list name: #
	editable: false
	show statistics: false
############################# Copyright stuff
card field:
	type: text
	name: illustrator
	default: set.artist
	description: The illustrator of the image
	icon: stats/illustrator.png
card field:
	type: text
	name: copyright
	default: set.copyright
	show statistics: false
	editable: false
card field:
	type: text
	name: copyright line
	save value: false
	show statistics: false
	script:
		forward_editor(field: card.copyright)
	description: The copyright and card number of the card
############################################################### Extra Statistics
statistics dimension:
	name: cost
	script: card.cost
	icon: stats/number.png
statistics dimension:
	name: power
	script: card.power
	icon: stats/number.png
statistics dimension:
	name: health
	script: card.health
	icon: stats/number.png
statistics dimension:
	name: text length (words)
	position hint: 100
	script: word_count(to_text(card.rule_text))
	numeric: true
	bin size: 5
	icon: stats/text_length.png
statistics dimension:
	name: text length (lines)
	position hint: 101
	script: line_count(to_text(card.rule_text))
	numeric: true
	icon: stats/text_length.png
statistics dimension:
	name: style
	position hint: 1001
	script: stylesheet.short_name
	icon: stats/stylesheet.png
############################################################## Auto replace
# Do we need categories?
#auto replace category: text box
#auto replace category: copyright
#auto replace category: everywhere
auto replace:
	match: (C)
	replace: ©
auto replace:
	match: AE
	replace: Æ
	whole word: false
auto replace:
	match: TM
	replace: ™
	whole word: false
auto replace:
	match: --
	replace: —
auto replace:
	# note the spaces
	match:
		 - 
	replace:
		 — 
auto replace:
	match: ~
	replace: CARDNAME
auto replace:
	match: '
	replace: ’
############################################################## Card pack items
pack type:
	name: card
	filter: card.name != ""
############################################################## Card packs
pack type:
	name: booster pack
	item:
		name: card
		amount: 1

has keywords: false